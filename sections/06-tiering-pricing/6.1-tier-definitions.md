# 6.1 Tier Definitions (Implementation Detail)

This section provides implementation-level detail for each tier in the CFO Business Intelligence Calculator Suite. These definitions expand on the business model outlined in Section 1.5 with specific technical gates, usage limits, and pricing structures needed for implementation.

---

## 1. Free Tier

### Features Included

**Calculator access**:
- âœ“ All calculators available (8 MVP calculators in Phase 1)
- âœ“ Single active scenario per calculator (cannot save multiple scenarios)
- âœ“ Key metrics only (monthly payment, total interest, total cost, breakeven units, etc.)
- âœ— Advanced metrics locked (DSCR, NPV/IRR, covenant headroom, contribution margin, sensitivity charts)

**Export capabilities**:
- âœ“ PDF exports with watermark ("Generated with Free Tier | Upgrade for clean exports")
- âœ“ CSV exports with header row: "# Free Tier Export | Upgrade to Pro for clean exports"
- âœ— Excel exports (Pro/B2B only)
- âœ— Clean exports without watermarks

**Monetization elements**:
- âœ“ Ad placement allowed (banner ads, affiliate links for lenders/brokers)
- âœ“ "Powered by [Brand]" footer on all pages and exports

**Sharing/collaboration**:
- âœ— Scenario sharing (cannot generate shareable links)
- âœ— Prepared by/reviewed by metadata (no audit trail)

### Usage Limits

| Limit Type | Free Tier Limit | Notes |
|------------|----------------|-------|
| **Calculations per day** | 100 per session | Resets at midnight UTC; session-based (not account-based) |
| **Exports per month** | 10 per session | Resets on 1st of month; counted per session ID |
| **Saved scenarios** | 0 (session-only) | Scenarios stored in browser localStorage or Redis with 24-hour expiry |
| **Scenario history** | None | No version tracking, no "undo" |
| **AI requests** | 0 | Feature locked (requires AI add-on) |

**Session-only storage**:
- Anonymous users: Scenarios saved in browser `localStorage` (lost if cache cleared)
- Logged-in Free tier users: Scenarios saved to database with 24-hour TTL (per Section 5.4)
- No cross-device sync (scenarios tied to specific browser/session)

### Technical Gates

**Code checks** (implemented in API Gateway and UI components):

```typescript
function canAccessFeature(feature: string, userTier: string): boolean {
  if (userTier === 'free') {
    const allowedFeatures = [
      'basic_calculations',
      'key_metrics',
      'watermarked_exports'
    ];
    return allowedFeatures.includes(feature);
  }
  // ... Pro/AI tier checks
}

function canAccessMetric(metricId: string, userTier: string): boolean {
  const advancedMetrics = ['dscr', 'npv', 'irr', 'covenant_headroom', 'contribution_margin'];
  if (advancedMetrics.includes(metricId) && userTier === 'free') {
    return false; // Lock advanced metrics for Free tier
  }
  return true;
}
```

**UI gates** (React components):
```typescript
{canAccessMetric('dscr', userTier) ? (
  <ResultCard label="DSCR" value={dscr} />
) : (
  <LockedMetric label="DSCR" onUpgrade={() => showUpgradeModal('pro')} />
)}
```

### Upgrade Triggers

**Attempting to create second scenario**:
- User clicks "+ Add Scenario" button
- System checks: `userTier === 'free'` â†’ show upgrade modal
- Modal message: "Unlock multiple scenarios with Pro. Compare side-by-side and save up to 50 scenarios per calculator."

**Clicking locked advanced metric**:
- User clicks blurred DSCR metric or "ðŸ”’ Unlock Pro" button
- Modal message: "Unlock CFO-grade metrics like DSCR, NPV/IRR, and covenant headroom. Get the insights lenders and boards expect."

**Requesting clean export**:
- User sees "Watermark-free exports available with Pro" message on export page
- Clicks "Upgrade for clean exports"
- Modal message: "Create board-ready PDFs and banker-friendly CSVs without watermarks or ads."

**Any AI request**:
- User clicks "âœ¨ AI Explanation" button
- Modal message: "Unlock AI-powered narratives and insights. Get plain-English explanations of your results."

### Pricing

**Free forever**: No credit card required, no trial expiration

---

## 2. Pro Tier

### Features Included

**Calculator access**:
- âœ“ All calculators (8 MVP + future expansion)
- âœ“ Multiple saved scenarios (up to 50 per calculator)
- âœ“ Key metrics + advanced metrics (DSCR, NPV/IRR, covenant headroom, contribution margin, sensitivity charts)
- âœ“ Scenario comparison (side-by-side tables, delta indicators)

**Export capabilities**:
- âœ“ Clean PDF exports (no watermarks, professional formatting)
- âœ“ Clean CSV exports (no header ads)
- âœ“ Excel exports (multi-tab, formulas preserved)
- âœ“ Version stamps and metadata in exports (formula versions, timestamps)

**Sharing/collaboration**:
- âœ“ Scenario sharing (shareable links with view-only or edit permissions)
- âœ“ Outputs-only sharing (share PDF/CSV without exposing inputs)
- âœ“ Prepared by/reviewed by metadata (lightweight audit trail)

**Monetization elements**:
- âœ— No ads (clean interface)
- âœ— No "Powered by" footer (except in B2B white-label, which removes even that)

### Usage Limits

| Limit Type | Pro Tier Limit | Notes |
|------------|---------------|-------|
| **Calculations per day** | 1,000 | Effectively unlimited for normal use |
| **Exports per month** | 100 | Resets on 1st of month |
| **Saved scenarios** | 50 per calculator | Total across all calculators: 50 Ã— 8 = 400 scenarios |
| **Scenario history** | Last 10 versions | Version tracking per scenario (who changed what, when) |
| **AI requests** | 0 | Requires AI add-on |

**Cross-device sync**:
- Scenarios saved to database (PostgreSQL)
- Accessible from any device (desktop, tablet, mobile)
- Retained for 24 months (per Section 5.4)

### Technical Gates

**Code checks**:
```typescript
function canSaveScenario(userTier: string, scenarioCount: number): boolean {
  if (userTier === 'free') return false; // Free tier can't save scenarios
  if (userTier === 'pro' && scenarioCount >= 50) {
    throw new Error('Pro tier limit: 50 scenarios per calculator');
  }
  return true;
}

function canAccessAdvancedMetrics(userTier: string): boolean {
  return ['pro', 'ai', 'b2b'].includes(userTier);
}
```

**Export watermark logic**:
```typescript
function shouldWatermarkExport(userTier: string): boolean {
  return userTier === 'free';
}

function generatePDF(scenario, userTier) {
  const template = loadTemplate('pdf_export');
  const watermarked = shouldWatermarkExport(userTier);

  if (watermarked) {
    template.footer = "Generated with Free Tier | Upgrade for clean exports";
  } else {
    template.footer = `Generated on ${timestamp} | Formula version ${version}`;
  }

  return renderPDF(template, scenario);
}
```

### Pricing

**Monthly**: $29/month (billed monthly)
**Annual**: $290/year (save $58, 17% discount)

**Trial**: 14 days free (no credit card required during trial)
- Trial starts when user clicks "Start Free Trial"
- Full Pro features during trial (100 exports, 50 scenarios, advanced metrics)
- Email reminders: 7 days before expiry, 1 day before expiry
- At trial end: Convert to paid or downgrade to Free (scenarios retained for 30 days)

### Upgrade Path

**From Free**:
- Click any upgrade trigger (locked metric, add scenario, clean export)
- Choose monthly or annual plan
- Enter payment details (Stripe Checkout)
- Immediate activation (scenarios unlock, advanced metrics visible)

**From Pro to AI**:
- Click "Add AI" button in account settings or "âœ¨ AI Explanation" in calculator
- Additional $20/month (total $49/month for Pro + AI)
- Immediate activation

---

## 3. AI Add-On Tier

### Features Included

**All Pro features, plus**:
- âœ“ AI narratives (plain-English explanations of results)
- âœ“ AI risk commentary (warnings, threshold interpretations, actionable suggestions)
- âœ“ AI scenario suggestions (e.g., "Consider extending loan term to improve DSCR")
- âœ“ "âœ¨ AI" badge on account (shows in profile, exports)

**AI capabilities per calculator**:
- Business Loan: "Your DSCR of 1.32 is above typical thresholds. Lenders typically require 1.25-1.50."
- Cash Runway: "At $85K/month burn, you have 9.2 months of runway. Consider fundraising by Month 6."
- Breakeven: "Your margin of safety is 15%. A small revenue miss could push you below breakeven."

### Usage Limits

| Limit Type | AI Add-On Limit | Notes |
|------------|-----------------|-------|
| **AI requests per month** | 50 | Hard cap (cannot exceed, even with payment) |
| **AI requests per day** | 20 | Prevents concentrated usage spikes |
| **AI narrative length** | ~200 words | LLM response truncated if excessive |
| **AI timeout** | 10 seconds | Hard timeout (fallback message if exceeded) |

**Request counting**:
- Each "âœ¨ AI Explanation" click = 1 request
- Failed requests (timeout, LLM error) = not counted
- Cached responses (same inputs within 1 hour) = not counted

**Rate limit warnings**:
- At 40/50 requests: "You've used 40 of 50 AI requests this month."
- At 50/50 requests: "You've reached your AI limit. Limit resets on [billing cycle date]."

### Technical Gates

**Code checks**:
```typescript
async function canRequestAI(userId: string, userTier: string): Promise<boolean> {
  if (!['ai', 'b2b'].includes(userTier)) {
    throw new Error('AI add-on required');
  }

  const usage = await getAIUsage(userId, currentBillingMonth());
  if (usage.request_count >= 50) {
    throw new Error('AI request limit exceeded. Resets on ' + usage.reset_date);
  }

  return true;
}

async function generateAINarrative(scenario, userId) {
  await canRequestAI(userId, user.tier); // Throws if not allowed

  // Increment counter
  await incrementAIUsage(userId, currentBillingMonth());

  // Call LLM API
  const narrative = await callLLM(scenario);
  return narrative;
}
```

**UI gates**:
```typescript
{userTier === 'ai' || userTier === 'b2b' ? (
  <button onClick={handleAIRequest}>âœ¨ AI Explanation</button>
) : (
  <button onClick={() => showUpgradeModal('ai')}>ðŸ”’ âœ¨ AI Explanation (Add-on)</button>
)}
```

### Pricing

**Monthly**: +$20/month on top of Pro (total $49/month)
**Annual**: +$200/year on top of Pro annual (total $490/year, save 17%)

**No separate trial**: AI add-on uses same 14-day trial as Pro tier
- During Pro trial, user can enable AI add-on (full 50 requests available)
- If user converts to paid Pro, AI add-on also converts to paid

### Upgrade Path

**From Pro**:
- Click "Add AI" button in account settings
- Or click "âœ¨ AI Explanation" button in calculator â†’ upgrade modal
- Stripe updates subscription (prorate current period)
- Immediate activation (AI requests reset to 50 for current month)

---

## 4. B2B / White-Label Tier

### Features Included

**All AI features, plus**:
- âœ“ Tenant configuration (branding, feature toggles, usage limits)
- âœ“ Custom domain support (calculators.acmecorp.com)
- âœ“ Branding removal (remove "Powered by" footer)
- âœ“ Custom branding (logo, colors, footer disclaimers)
- âœ“ API access with keys (programmatic calculator usage)
- âœ“ Priority support (dedicated Slack channel, 4-hour SLA)
- âœ“ Self-hosted deployment option (Docker/Kubernetes images)

**Tenant-level controls**:
- Admin dashboard: Manage users, configure branding, view usage analytics
- Feature toggles: Enable/disable AI, specific calculators, or advanced metrics per tenant
- Usage limits: Custom limits per tenant (e.g., 200 scenarios per user, 500 exports per month)
- Data retention: Custom retention policies (per Section 5.4)

### Usage Limits (Default, Configurable)

| Limit Type | B2B Default Limit | Configurable Range |
|------------|-------------------|-------------------|
| **Calculations per day** | 10,000 (tenant-wide) | 1,000 - unlimited |
| **Exports per month** | 500 (tenant-wide) | 100 - unlimited |
| **Scenarios per user** | 50 | 10 - 200 |
| **AI requests per month** | 0 or 1000 (if enabled) | 0 - 5,000 |
| **API calls per day** | 10,000 | 1,000 - unlimited |

**Multi-user tenants**:
- Usage pooled across all tenant users (e.g., 10 users Ã— 10,000 calculations = 100K tenant-wide limit)
- Admin can view per-user usage in tenant dashboard

### Technical Gates

**Tenant config schema** (stored in database):
```json
{
  "tenant_id": "acme_corp",
  "tier": "b2b",
  "plan": "enterprise",
  "features": {
    "ai_enabled": false,
    "white_label": true,
    "custom_domain": "calculators.acmecorp.com",
    "api_access": true,
    "max_scenarios_per_user": 100,
    "max_exports_per_month": 1000
  },
  "branding": {
    "logo_url": "https://cdn.acmecorp.com/logo.png",
    "primary_color": "#0066CC",
    "footer_disclaimer": "Custom disclaimer text"
  },
  "api_keys": [
    {
      "key_id": "sk_live_abc123",
      "created_at": "2025-01-01",
      "last_used": "2025-01-15"
    }
  ]
}
```

**Code checks**:
```typescript
function getTierConfig(userId: string): TierConfig {
  const user = getUser(userId);

  // B2B users inherit tenant config
  if (user.tenant_id) {
    const tenant = getTenant(user.tenant_id);
    return {
      tier: 'b2b',
      features: tenant.features,
      branding: tenant.branding,
      limits: tenant.usage_limits
    };
  }

  // Individual users use standard tier config
  return getStandardTierConfig(user.tier);
}
```

### Pricing Models

**Per-Seat Pricing**:
- $39/user/month (minimum 5 seats = $195/month)
- Billed monthly or annually (annual = 15% discount)
- Volume discounts:
  - 10% off for 50+ seats ($35/user/month)
  - 20% off for 100+ seats ($31/user/month)

**Per-Domain Pricing**:
- $500/month for unlimited users on one domain
- Suitable for: Lenders embedding calculators on loan origination sites, advisors with 50+ client-facing users
- Add-on domains: +$300/month per additional domain

**Usage-Based Pricing**:
- $0.10 per calculation (minimum $200/month)
- Suitable for: API-driven integrations with variable usage
- Overage billing: If usage exceeds prepaid minimum, billed at $0.10/calculation

**Setup fee** (one-time):
- $500 for standard setup (branding, domain configuration)
- $2,000 for custom setup (self-hosted deployment, SSO integration)

### Upgrade Path

**From Pro or AI**:
- Contact sales (no self-serve signup for B2B)
- Discovery call: Understand use case, user count, integration needs
- Proposal: Custom pricing based on seats, domains, or usage
- Contract: Annual contract preferred (month-to-month available at +20% premium)
- Onboarding: 2-4 weeks (tenant setup, branding, user training)

---

## Tier Comparison Table

| Feature | Free | Pro | AI Add-On | B2B |
|---------|------|-----|-----------|-----|
| **Pricing** | $0 | $29/mo or $290/yr | +$20/mo ($49/mo total) | Custom (starts $195/mo) |
| **Trial** | N/A | 14 days | Included in Pro trial | Custom (30-60 days) |
| **Saved scenarios** | 0 (session-only) | 50 per calculator | 50 per calculator | Configurable (default 50) |
| **Key metrics** | âœ“ | âœ“ | âœ“ | âœ“ |
| **Advanced metrics** | âœ— | âœ“ (DSCR, NPV/IRR, etc.) | âœ“ | âœ“ |
| **Calculations/day** | 100 | 1,000 | 1,000 | 10,000 (tenant-wide) |
| **Exports/month** | 10 (watermarked) | 100 (clean) | 100 (clean) | 500 (clean, configurable) |
| **Export formats** | PDF, CSV (watermarked) | PDF, CSV, Excel | PDF, CSV, Excel | PDF, CSV, Excel |
| **Scenario sharing** | âœ— | âœ“ | âœ“ | âœ“ |
| **AI narratives** | âœ— | âœ— | âœ“ (50/month) | âœ“ (configurable) |
| **AI requests/month** | 0 | 0 | 50 | 0-5,000 (configurable) |
| **Branding** | Ads + "Powered by" | No ads | No ads | White-label (custom branding) |
| **API access** | âœ— | âœ— | âœ— | âœ“ (with API keys) |
| **Custom domain** | âœ— | âœ— | âœ— | âœ“ |
| **Priority support** | Community | Email (24h SLA) | Email (24h SLA) | Dedicated (4h SLA) |
| **Self-hosted option** | âœ— | âœ— | âœ— | âœ“ (custom setup) |

---

## Implementation Checklist

**To implement tiering**:
1. **Database schema**: Add `tier` column to `users` table (enum: 'free', 'pro', 'ai', 'b2b')
2. **Feature flags**: Implement tier checks in API Gateway (per Section 6.2)
3. **UI gates**: Lock/unlock features based on `userTier` prop (React components)
4. **Usage tracking**: Redis counters for calculations, exports, AI requests (per Section 5.2)
5. **Stripe integration**: Subscription creation, webhook handling (per Section 6.3)
6. **Upgrade modals**: Design and implement upgrade prompts (per Section 6.3)
7. **Trial management**: 14-day trial countdown, email reminders, auto-downgrade
8. **B2B tenant config**: Database table + admin dashboard for tenant management

**Testing checklist**:
- [ ] Free tier cannot save scenarios (blocked with upgrade prompt)
- [ ] Free tier cannot access advanced metrics (locked with blur overlay)
- [ ] Pro tier can save up to 50 scenarios per calculator
- [ ] Pro tier can export clean PDFs (no watermark)
- [ ] AI tier can request narratives (up to 50/month, then blocked)
- [ ] B2B tenant users inherit tenant config (branding, limits)
- [ ] Upgrade from Free â†’ Pro activates immediately (scenarios unlock)
- [ ] Trial expiry downgrades to Free (scenarios retained for 30 days)

---

## Summary

These tier definitions provide implementation-ready specifications for Free/Pro/AI/B2B tiering. Key takeaways:
- **Free tier**: Limited to session-only scenarios, watermarked exports, 100 calcs/day
- **Pro tier**: 50 scenarios per calculator, advanced metrics, clean exports, $29/month
- **AI add-on**: +$20/month for AI narratives (50 requests/month)
- **B2B tier**: Custom pricing, white-label, API access, tenant configuration

All tier checks enforced server-side (never trust client) with clear upgrade prompts when users attempt to access locked features.
